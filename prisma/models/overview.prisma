/// ========================================
/// MARKET OVERVIEW MODELS
/// ========================================

/// 시장 개요 및 분석 요약
/// 해당 날짜의 시장에 대한 주관적 생각, 변동성, 영향력 등을 정리
/// 시황 하위 테이블들과 연결되어 종합적인 시장 분석 제공
model Overview {
  id Int @id @default(autoincrement()) // 고유식별자
  journal_item_id Int @unique // JournalItem 참조 (시황이 작성된 복기 기록)
  thought String @default("") // 시장에 대한 주관적 생각 또는 인사이트
  volatility ScoreType // 시장 변동성 평가 점수 (VeryHigh ~ VeryLow)
  market_impact ScoreType // 시장 영향력 평가 점수 (VeryHigh ~ VeryLow)

  // Relations
  journal_item JournalItem @relation(fields: [journal_item_id], references: [id])
  
  // Sub-overview relations
  chart_overviews ChartOverview[]
  indicator_overviews IndicatorOverview[]
  macro_overviews MacroOverview[]
  event_overviews EventOverview[]
}

/// 관심 종목 차트 분석 요약
/// 시황 복기에서 관심 종목별로 시각적 분석 포인트를 정리
/// 심볼, 관심 이유, 중요도 등을 기록
model ChartOverview {
  id Int @id @default(autoincrement()) // 고유식별자
  overview_id Int // Overview 참조 (해당 시황 개요와 연결)
  symbol_id Int // Symbol 참조 (관찰 대상 종목)
  interest ScoreType // 해당 종목에 대한 관심도 평가 (VeryHigh ~ VeryLow)
  interest_reason String @default("") // 관심을 가진 이유 또는 시장 포인트

  // Relations
  overview Overview @relation(fields: [overview_id], references: [id])
  symbol Symbol @relation(fields: [symbol_id], references: [id])

  @@index([overview_id])
  @@index([symbol_id])
}

/// 시장 지표 수치 기록
/// 시장 시황 복기 중 지표 수치를 기록
/// 공포탐욕지수(GreedAndFear), 온체인 지표 등 정량적 수치를 저장
model IndicatorOverview {
  id Int @id @default(autoincrement()) // 고유식별자
  overview_id Int // Overview 참조 (해당 시황 개요와 연결)
  indicator_id Int // Indicator 참조 (사용된 지표)
  value String // 지표 수치 값 (예: 73) - 부동소수점 오차 방지를 위해 문자열로 저장

  // Relations
  overview Overview @relation(fields: [overview_id], references: [id])
  indicator Indicator @relation(fields: [indicator_id], references: [id])

  @@index([overview_id])
  @@index([indicator_id])
}

/// 거시경제 이벤트 기록
/// FOMC, 고용지표 등 거시경제 이벤트 발표 시점의 이전/예상/실제 수치를 기록
/// 시장 반응 해석 및 예측 정확도 분석에 활용
model MacroOverview {
  id Int @id @default(autoincrement()) // 고유식별자
  overview_id Int // Overview 참조 (해당 시황 개요와 연결)
  previous String // 이전 수치 (직전 발표 값) - 부동소수점 오차 방지를 위해 문자열로 저장
  forecast String // 시장 예상 수치 - 부동소수점 오차 방지를 위해 문자열로 저장
  actual String // 실제 발표 수치 - 부동소수점 오차 방지를 위해 문자열로 저장

  // Relations
  overview Overview @relation(fields: [overview_id], references: [id])

  @@index([overview_id])
}

/// 시장 영향 이벤트 기록
/// 뉴스, 정책, 소셜 미디어 등 이벤트 기반 시황 요소를 기록
/// 시장에 영향을 줄 수 있는 외부 이벤트 유형을 구분하여 분석
model EventOverview {
  id Int @id @default(autoincrement()) // 고유식별자
  overview_id Int // Overview 참조 (이 이벤트가 포함된 시황)
  type EventType // 이벤트 유형 (News / Policy / SocialMedia)
  description String @default("") // 이벤트에 대한 내용

  // Relations
  overview Overview @relation(fields: [overview_id], references: [id])

  @@index([overview_id])
  @@index([type])
}